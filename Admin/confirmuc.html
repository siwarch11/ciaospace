<script>
    if(!localStorage.getItem("idAdmin"))
    {
      location.replace("login.html");
    }
  </script>
<!DOCTYPE html>
<html lang="en">
<head>

  <script src="https://static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>

    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
     <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <!-- Tempusdominus Bootstrap 4 -->
  <link rel="stylesheet" href="plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
  <!-- iCheck -->
  <link rel="stylesheet" href="plugins/icheck-bootstrap/icheck-bootstrap.min.css">
  <!-- JQVMap -->
  <link rel="stylesheet" href="plugins/jqvmap/jqvmap.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/adminlte.min.css">
  <!-- overlayScrollbars -->
  <link rel="stylesheet" href="plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
  <!-- Daterange picker -->
  <link rel="stylesheet" href="plugins/daterangepicker/daterangepicker.css">
  <!-- summernote -->
  <link rel="stylesheet" href="plugins/summernote/summernote-bs4.min.css">
</head>
<body class="hold-transition sidebar-mini layout-fixed">
    <div class="wrapper">
    
      <!-- Preloader -->
      <div class="preloader flex-column justify-content-center align-items-center">
        <img class="animation__shake" src="dist/img/AdminLTELogo.png" alt="AdminLTELogo" height="60" width="60">
      </div>
    
      <!-- Navbar -->
      <nav class="main-header navbar navbar-expand navbar-white navbar-light">
        <!-- Left navbar links -->
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
          </li>
          <li class="nav-item d-none d-sm-inline-block">
            <a href="index.html" class="nav-link">Home</a>
          </li>
         
        </ul>
    
      </nav>
      <!-- /.navbar -->
    
      <!-- Main Sidebar Container -->
    <!-- Main Sidebar Container -->
    <aside class="main-sidebar sidebar-dark-primary elevation-4">
      <!-- Brand Logo -->
      <a href="index.html" class="brand-link">
        <img src="dist/img/AdminLTELogo.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
        <span class="brand-text font-weight-light">Admin </span>
      </a>
    
      <!-- Sidebar -->
      <div class="sidebar">
        <!-- Sidebar user panel (optional) -->
        <div class="user-panel mt-3 pb-3 mb-3 d-flex">
          <div class="image" id="i">
          
            
          </div>
          <div class="info">
            <a href="profile1.html" id="usernameAdmin" class="d-block">Alexander Pierce</a>
          </div>
        </div>
    
        <!-- SidebarSearch Form -->
        <div class="form-inline">
         
        </div>
    
        <!-- Sidebar Menu -->
        <nav  class="mt-2">
          <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
            <!-- Add icons to the links using the .nav-icon class
                 with font-awesome or any other icon font library -->
            <li class="nav-item menu-open">
              <a href="index.html" class="nav-link">
                <i class="nav-icon fas fa-tachometer-alt"></i>
                <p>
                  Dashboard
                  
                </p>
              </a>
              
            </li>
            
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="nav-icon fas fa-user" aria-hidden="true"></i>
                <p>
                  Admins
                  <i class="fas fa-angle-left right"></i>
                  
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a href="addadmin.html" class="nav-link">
                    <i class="far fa-circle nav-icon"></i>
                    <p>Add</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="admins.html" class="nav-link">
                    <i class="far fa-circle nav-icon"></i>
                    <p>List</p>
                  </a>
                </li>
    
              </ul>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link">
                <i class="nav-icon fas fa-users" aria-hidden="true"></i>
                <p>
                  users
                  <i class="right fas fa-angle-left"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a href="Adduser.html" class="nav-link">
                    <i class="far fa-circle nav-icon"></i>
                    <p>Add</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="users.html" class="nav-link">
                    <i class="far fa-circle nav-icon"></i>
                    <p>List</p>
                  </a>
                </li>
                
              </ul>
            </li>
            <li class="nav-item">
              <a href="#" class="nav-link ">
                <i class="nav-icon fas fa-user-circle" aria-hidden="true"></i>
                <p>
                  partners
                  <i class="fas fa-angle-left right"></i>
                </p>
              </a>
              <ul class="nav nav-treeview">
                <li class="nav-item">
                  <a href="Addpartner.html" class="nav-link">
                    <i class="far fa-circle nav-icon"></i>
                    <p>Add</p>
                  </a>
                </li>
                <li class="nav-item">
                  <a href="partners.html" class="nav-link">
                    <i class="far fa-circle nav-icon"></i>
                    <p>List</p>
                  </a>
                </li>
              </ul>
              <li class="nav-item">
    
                <a href="#" class="nav-link active">
    
                  <i class="nav-icon fas fa-edit" aria-hidden="true"></i>
    
                  <p>
                    offers
                    <i class="fas fa-angle-left right"></i>
                  </p>
                </a>
                <ul class="nav nav-treeview">
                  <li class="nav-item">
                    <a href="confirm.html" class="nav-link">
                      <i class="far fa-circle nav-icon"></i>
                      <p>confirm</p>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a href="unconfirm.html" class="nav-link">
    
                      <i class="far fa-circle nav-icon"></i>
                      <p>unconfirm</p>
    
                    </a>  
                </ul>
    
              </li>
            </li>
            <li class="nav-item">
              <a href="reclamation.html" class="nav-link ">
                <i class="nav-icon fas fa-comment"></i>
                <p>
                  Reclamation
                  
                </p>
              </a>
              
            </li>
            <li class="nav-item">
              <a href="login.html" onclick="logout()" class="nav-link">
                <i class="nav-icon fas fa-lock" aria-hidden="true"></i> 
                <p>
                  log out
                </p>
              </a>
              
            </li>
          </ul>
        </nav>
        <!-- /.sidebar-menu -->
      </div>
      <!-- /.sidebar -->
    </aside>
    
      <script>
        function logout(){
                       
          var d = window.confirm("want to LogOut?");
          if (d == true)
          {
            localStorage.removeItem("idAdmin");
          }
        }
      </script>
      <!-- Content Wrapper. Contains page content -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <div class="content-header">
          <div class="container-fluid">
            <div class="row mb-2">
              <!-- /.col -->
              <div class="col-sm-6">
                <ol class="breadcrumb float-sm-right">
                  <li class="breadcrumb-item"><a href="#">Home</a></li>
                  <li class="breadcrumb-item active ">Offers</li>
                </ol>
              </div><!-- /.col -->
            </div><!-- /.row -->
          </div><!-- /.container-fluid -->
        </div>
        <!-- /.content-header -->
    <section class="content">
       <div class="row">
        <div class="col-lg-2">  </div>
            <div class="col-lg-8">
<div class="card card-primary">
        <div class="card-header">
          <h3 class="card-title">Confirm Offer</h3>
        </div>
    <form onsubmit="return false">
      <label for="title">title</label>
        <input type="titte" id="title" class="form-control" placeholder="Enter title">
        <label for="title">description</label>
        <input type="text"  class="form-control" id="description" placeholder="Enter description">
        <label for="title">Category</label>
        <input type="text"  class="form-control" id="category" placeholder="Enter category">
        <label for="title">image</label>
        <input type="text"  class="form-control" id="i" onclick="send()" placeholder="Enter image">
        <label for="title">price</label>
        <input type="text"  class="form-control" id="price" placeholder="Enter price">
        <label for="title">Region</label>
        <input type="text"  class="form-control" id="region" placeholder="Enter region">
        <input type="hidden" id="facility">
        <input type="hidden" id="specialoffer">
        <input type="hidden" id="discount">
        <input type="hidden" id="date">
        <input type="hidden" id="number">
        <input type="hidden" id="page">
        <input type="hidden" id="position">
        <input type="hidden" id="cancellation">
        <input type="hidden" id="period">
        <input type="hidden" id="companion">
        <input type="hidden" id="kitchen">
        <input type="hidden" id="activities">
        <input type="hidden" id="openingtime">
        <input type="hidden" id="closingtime">
        <input type="hidden" id="localisation">

        <input type="hidden" id="email">

        <input type="submit" class="btn btn-primary" value="Confirm Offer" onclick="confirm()">
    </div>
  </div> 
</div></div>
    </form>
    
    <script>
      function send() {
        var i = document.getElementById("i");
        const apikey = "AAewK2vTzOjcMDFNrTZTwz";
        const client = filestack.init(apikey);
        const options = {
          maxFiles: 20,
          uploadInBackground: false,
          onOpen: () => console.log("opened!"),
          onUploadDone: (res) => (i.value = res.filesUploaded[0].url),
        };
        client.picker(options).open();
      }
    </script>
    
    <script>
        var url_string = window.location.href //url_string = "file:///C:/Users/Client/Desktop/pfe/Admin/confirmuc.html?id=6246ce5a5873e31e943ab7a3"
        var url = new URL(url_string); //url = file:///C:/Users/Client/Desktop/pfe/Admin/confirmuc.html?id=6246ce5a5873e31e943ab7a3
        var c = url.searchParams.get("id"); //c =6246ce5a5873e31e943ab7a3
        console.log(c);

        // Post a user
        var url3 = "http://192.168.37.220:3000/offres/" + c ;
        var xhr3 = new XMLHttpRequest();
        xhr3.open("GET", url3, true);

        xhr3.onload = function () {
            var offres = JSON.parse(xhr3.responseText);
            if (xhr3.readyState == 4 && xhr3.status == "200") {
                document.getElementById("title").value = offres.title;
                document.getElementById("description").value = offres.description;
                document.getElementById("category").value = offres.category;
                document.getElementById("facility").value = offres.facility;
                document.getElementById("date").value = offres.date;
                document.getElementById("discount").value = offres.discount;
                document.getElementById("specialoffer").value = offres.specialoffer;
                document.getElementById("number").value = offres.number;
                document.getElementById("page").value = offres.page;
                document.getElementById("position").value = offres.position;
                document.getElementById("cancellation").value = offres.cancellation;
                document.getElementById("period").value = offres.period;
                document.getElementById("companion").value = offres.companion;
                document.getElementById("kitchen").value = offres.kitchen;
                document.getElementById("activities").value = offres.activities;
                document.getElementById("openingtime").value = offres.openingtime;
                document.getElementById("closingtime").value = offres.closingtime;
                document.getElementById("localisation").value = offres.localisation;
                document.getElementById("email").value = offres.email;




                document.getElementById("i").value = offres.image;
                document.getElementById("price").value = offres.price;
                document.getElementById("region").value = offres.region;
            } else {

                console.log("error");
            }
        }

        xhr3.send(null);
//`<a href="confirm.html?id=`+i._id+`">Confirm</a>`
        function confirm(){
            var url_string = window.location.href
            var url = new URL(url_string);
            var c = url.searchParams.get("id");
                
                    var url = "http://192.168.37.220:3000/offres/"+c;
                                    
                    var data = {};
                    data.title   = document.getElementById("title").value;
                    data.description   = document.getElementById("description").value;
                    data.image   = document.getElementById("i").value;
                    data.category   = document.getElementById("category").value;
                    data.price     = document.getElementById("price").value;
                    data.region =document.getElementById("region").value;
                    data.facility =document.getElementById("facility").value;
                    data.date =document.getElementById("date").value;
                    data.discount =document.getElementById("discount").value;
                    data.specialoffer =document.getElementById("specialoffer").value;
                    data.number =document.getElementById("number").value;
                    data.page =document.getElementById("page").value;
                    data.position =document.getElementById("position").value;
                    data.cancellation =document.getElementById("cancellation").value;
                    data.period =document.getElementById("period").value;
                    data.companion =document.getElementById("companion").value;
                    data.kitchen =document.getElementById("kitchen").value;
                    data.activities =document.getElementById("activities").value;
                    data.openingtime =document.getElementById("openingtime").value;
                    data.closingtime =document.getElementById("closingtime").value;
                    data.localisation =document.getElementById("localisation").value;
                    data.email =document.getElementById("email").value;

                data.idPart = localStorage.getItem("idPartner");

                    data.status = "1";
                    var json = JSON.stringify(data);
                    var xhr = new XMLHttpRequest();
                    xhr.open("PUT", url, true);
                    xhr.setRequestHeader('Content-type','application/json; charset=utf-8');
                    xhr.onload = function () {
                        var offres = JSON.parse(xhr.responseText);
                        if (xhr.readyState == 4 && xhr.status == "200") {
                            alert("Offres confirmed!");
                            location.replace("confirm.html");
                        } else {
                            console.error(offres);
                            location.replace("unconfirm.html");
                        }
                    }
                    xhr.send(json);
               
        }
    </script>
    <footer class="main-footer">
    <strong>Copyright &copy; 2022 <a target="_blank" href="https://chaabengroup.com/">chaaben Technology Group</a>.</strong>
    All rights reserved.
    <div class="float-right d-none d-sm-inline-block">
      <b>Version</b> 1.0
    </div>
  </footer>
<script src="https://static.filestackapi.com/filestack-js/3.x.x/filestack.min.js"></script>

     <script src="plugins/jquery/jquery.min.js"></script>
     <!-- jQuery UI 1.11.4 -->
     <script src="plugins/jquery-ui/jquery-ui.min.js"></script>
     <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
     <script>
       $.widget.bridge('uibutton', $.ui.button)
     </script>
     <!-- Bootstrap 4 -->
     <script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
     <!-- ChartJS -->
     <script src="plugins/chart.js/Chart.min.js"></script>
     <!-- Sparkline -->
     <script src="plugins/sparklines/sparkline.js"></script>
     <!-- JQVMap -->
     <script src="plugins/jqvmap/jquery.vmap.min.js"></script>
     <script src="plugins/jqvmap/maps/jquery.vmap.usa.js"></script>
     <!-- jQuery Knob Chart -->
     <script src="plugins/jquery-knob/jquery.knob.min.js"></script>
     <!-- daterangepicker -->
     <script src="plugins/moment/moment.min.js"></script>
     <script src="plugins/daterangepicker/daterangepicker.js"></script>
     <!-- Tempusdominus Bootstrap 4 -->
     <script src="plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js"></script>
     <!-- Summernote -->
     <script src="plugins/summernote/summernote-bs4.min.js"></script>
     <!-- overlayScrollbars -->
     <script src="plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
     <!-- AdminLTE App -->
     <script src="dist/js/adminlte.js"></script>
     <!-- AdminLTE for demo purposes -->
     <script src="dist/js/demo.js"></script>
     <!-- AdminLTE dashboard demo (This is only for demo purposes) -->
     <script src="dist/js/pages/dashboard.js"></script>
     <script>
        var c =localStorage.getItem("idAdmin"); 
         console.log(c);
       
         // Post a user
         var url4 = "http://192.168.37.220:3000/admins/" + c ;
         var xhr4 = new XMLHttpRequest();
         xhr4.open("GET", url4, true);
       
         xhr4.onload = function () {
             var admins = JSON.parse(xhr4.responseText);
             if (xhr4.readyState == 4 && xhr4.status == "200") {
               document.getElementById("usernameAdmin").innerHTML =admins.fname +` `+admins.lname ;
              document.getElementById("i").innerHTML = `<img src="`+admins.image+`"alt="User" class="img-size-50 mr-3 img-circle">`;
                 
             } else {
       
                 console.log("error");
             }
         }
       
         xhr4.send(null);
       </script>
</body>
</html>